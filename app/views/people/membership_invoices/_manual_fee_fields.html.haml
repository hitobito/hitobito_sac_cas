-#  Copyright (c) 2026, Schweizer Alpen-Club. This file is part of
-#  hitobito_sac_cas and licensed under the Affero General Public License version 3
-#  or later. See the COPYING file at the top-level directory or at
-#  https://github.com/hitobito/hitobito_sac_cas.

= field_set_tag t('.manual_positions_subtitle') do
  = f.labeled_input_field(:sac_fee, addon: t('global.currency'), type: 'number', step: 0.01)
  = f.labeled_input_field(:sac_entry_fee, addon: t('global.currency'), type: 'number', step: 0.01, help: t(".do_not_transmit_nil_values_help"))
  = f.labeled_input_fields(:hut_solidarity_fee, :sac_magazine, addon: t('global.currency'), type: 'number', step: 0.01)
  - if f.object.magazine_postage_abroad_active?
    = f.labeled_input_field(:sac_magazine_postage_abroad, addon: t('global.currency'), type: 'number', step: 0.01)
  = f.labeled_input_field(:section_entry_fee, label: t(".section_entry_fee", section: f.object.member.stammsektion), addon: t('global.currency'), type: 'number', step: 0.01, help: t(".do_not_transmit_nil_values_help"))
  - f.object.member.active_memberships.each do |membership|
    - section_fee = f.object.section_fees.find { _1.section.id == membership.section.id }
    = f.fields_for :section_fees, section_fee do |section_fee_fields|
      = section_fee_fields.hidden_field(:section_id, value: section_fee_fields.object.section.id)
      = section_fee_fields.labeled_input_field(:fee, label: t(".section_fee", section: membership.section), addon: t('global.currency'), type: 'number', step: 0.01)
    - if f.object.section_bulletin_postage_abroad_active?(membership)
      - section_bulletin_postage_abroad = f.object.section_bulletin_postage_abroad.find { _1.section.id == membership.section.id }

      = f.fields_for :section_bulletin_postage_abroad, section_bulletin_postage_abroad do |section_fee_fields|
        = section_fee_fields.hidden_field(:section_id, value: section_fee_fields.object.section.id)
        = section_fee_fields.labeled_input_field(:fee, label: t(".section_bulletin_postage_abroad", section: membership.section), addon: t('global.currency'), type: 'number', step: 0.01)
